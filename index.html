<HTML>
	<HEAD>
		<TITLE>SlideShow</TITLE>

		<style type="text/css">
		.showbox {
			display: inline-block;
		}
		.showbox p {
			text-align: center;
		}
		.showbox img {
			border: 2px solid skyblue;
		}
		</style>

	</HEAD>
	<BODY>
		<div class="showbox">
			<p>
				<img src="default.jpg" width="640" height="480" id="slideshow" alt="slide show">
			</p>
			<p>
				<input type="button" value="- BACK -" id="back">
				<input type="button" value="- START/STOP -" id="startstop">
				<input type="button" value="- NEXT -" id="next">
			</p>
		</div>
		<script type="text/javascript">
		function changeToPrePhoto(){
			document.getElementById('slideshow').src = ''
		}
		function changeToNextPhoto(){
			document.getElementById('slideshow').src = ''
		}
		function getPhotosURL(url){
			return new Promise((resolve, reject) => {
				var request = new XMLHttpRequest();
				request.open('GET', url);
				request.onload = function () {
					if (this.status === 200) {
						resolve (this.response);
					}
				};
				request.send(null);
			});
		}
		function toggleStartStop(){
			getPhotosURL('https://gcg42ovcg8.execute-api.ap-northeast-1.amazonaws.com/prod/photos').then((res) => {
				res = JSON.parse(res);
				console.log('res: ', res);
				for(i = 0; i < res.keys.length; i++){
					(function(pram) {
						setTimeout(function() {
							console.log(res.keys[pram]);
							document.getElementById('slideshow').src = 'https://s3-ap-northeast-1.amazonaws.com/' + res.keys[pram]
						}, pram * 1000);
					})(i);
				};
			});
		}

		// ▼ボタンクリックに関数を割り当てる
		document.getElementById('startstop').onclick = toggleStartStop;
		document.getElementById('back').onclick = changeToPrePhoto;
		document.getElementById('next').onclick = changeToNextPhoto;
		</script>
	</BODY>
</HTML>
